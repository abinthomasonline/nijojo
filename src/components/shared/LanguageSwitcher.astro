---
import { languages } from '../../i18n/ui';
import { withBase } from '../../utils/url';

interface Props {
  currentLocale: string;
  currentPath: string;
}

const { currentLocale, currentPath } = Astro.props;

// Strip base URL from currentPath if present
const baseUrl = import.meta.env.BASE_URL.replace(/\/$/, '');
const pathWithoutBase = currentPath.startsWith(baseUrl)
  ? currentPath.slice(baseUrl.length)
  : currentPath;

// Generate alternate URL
const alternateLocale = currentLocale === 'en' ? 'ml' : 'en';
const alternatePath = currentLocale === 'en'
  ? withBase(`/ml${pathWithoutBase}`)
  : withBase(pathWithoutBase.replace('/ml', '') || '/');
---

<div class="flex items-center gap-2 bg-white rounded-lg shadow-lg p-1 border-2 border-gray-200">
  <a
    href={currentLocale === 'en' ? currentPath : alternatePath}
    class={`px-4 py-2 rounded-md text-sm font-bold transition-all ${
      currentLocale === 'en'
        ? 'bg-primary text-white shadow-md'
        : 'text-gray-700 hover:bg-gray-100 hover:text-primary'
    }`}
  >
    {languages.en}
  </a>
  <a
    href={currentLocale === 'ml' ? currentPath : alternatePath}
    class={`px-4 py-2 rounded-md text-sm font-bold transition-all ${
      currentLocale === 'ml'
        ? 'bg-primary text-white shadow-md'
        : 'text-gray-700 hover:bg-gray-100 hover:text-primary'
    }`}
  >
    {languages.ml}
  </a>
</div>
